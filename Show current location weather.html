
<head>
	<title>Weather App</title>
	<meta charset="utf-8">
	<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.2.1.min.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>


<script type="text/javascript">
// To access 3rd API (cross domain access), we can use CORS or JSONP. Recomendation: webserver should support these function first
// IE support: https://cypressnorth.com/programming/cross-domain-ajax-request-with-json-response-for-iefirefoxchrome-safari-jquery/
	

	$(document).ready(function() {
		var x= 123;
		function getWeather() {
			if (navigator.geolocation) {										// check if browser support geo
				navigator.geolocation.getCurrentPosition(function (data) {		// if yes get the location
					var latitude = data.coords.latitude;						// extract latitude from object
					var longitude = data.coords.longitude;						// extract longitude from object
					
					showCityName(latitude, longitude);
					getWeatherData(latitude, longitude);
					
				});			
			} else {
				console.log("Geolocation is not supported by this browser.");
			}
		}
		
		// OpenStreetMap: reserved GEO location
		// http://wiki.openstreetmap.org/wiki/Donations
		function showCityName(x, y) {
			var getCityAPI = "http://nominatim.openstreetmap.org/reverse?format=json&lat=" + x + "&lon=" + y;
			$.ajax ({
				url: getCityAPI,
				success: function (data) {
					$("#yourLocation").html("Your location: " + data.address.city + ", " + data.address.country);
					},
				cache: false
			});
			
		}
		
		// https://darksky.net/dev
		// Your Secret Key:  40010c1cd4226676466f1d8c8173ae12
		function getWeatherData(x, y) {
			var darkskyAPI = "https://crossorigin.me/https://api.darksky.net/forecast/40010c1cd4226676466f1d8c8173ae12/" + x + "," + y + "?exclude=minutely,hourly,daily,flags";
			$.ajax ({
				url: darkskyAPI,
				success: function (data) {
					$("#tempDisplay").html(data.currently.apparentTemperature + " &deg;F");
				}
			});
		}
		getWeather();
		
		
		$("#F2C").click(function() {
			if (this.checked) {
				console.log(x);
			}
			else {
				console.log("unchecked");
			}
		});
	});
</script>

<style>
	#header {
		background-color: #007ec3;
		color: white;
	}
</style>


<body>
	<!-- Animated weather icon: https://codepen.io/joshbader/full/EjXgqr/ -->
	<div class="container-fluid text-center" id="header">
		<h1>My Weather App</h1>
		<h4 id="yourLocation"> <br> </h4>
	</div>
	
	<!-- Display weather -->	
	<div class="text-center">
		<h1> Animated weather icon </br> </h1>
		<div class="row">
			<h1> Temperature is </h1>
			<h1 id="tempDisplay"> caculated now </h1>
		</div>
		<!-- Switch between C and F -->	
		<label><input type="checkbox" id="F2C">  I want Celcius</label>
	</div>
</body>
 
